根据进程名监控其运行过程中的内存占用情况

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
# coding:gbk
import os, re
import time
import string

import xlrd
from xlutils.copy import copy


def countProcessMemoey(processName):
    pattern = re.compile(r'([^\s]+)\s+(\d+)\s.*\s([^\s]+\sK)')
    cmd = 'tasklist /fi "imagename eq ' + processName + '"' + ' | findstr.exe ' + '"'+ processName + '"'
    # findstr后面的程序名加上引号防止出现程序带有空格
    result = os.popen(cmd).read()
    resultList = result.split("\n")
    
    for srcLine in resultList:
        srcLine = "".join(srcLine.split('\n'))
        if len(srcLine) == 0:
            break
        m = pattern.search(srcLine)
        if m == None:
            continue
        # 由于是查看python进程所占内存，因此通过pid将本程序过滤掉
        if str(os.getpid()) == m.group(2):
            continue
        ori_mem = m.group(3).replace(',','')
        ori_mem = ori_mem.replace(' K','')
        ori_mem = ori_mem.replace(r'\sK','')
        memEach = int(ori_mem)
        print ('ProcessName:'+ m.group(1) + '\tPID:' + m.group(2) + '\tmemory size:%.2f'% (memEach * 1.0 /1024), 'M')
        cpu = '%.2f'% (memEach * 1.0 /1024) +'M'
        # print(time.ctime())  # 打印当前的时间
        value = [time.ctime(), cpu]
        rb = xlrd.open_workbook(r'./monitor.xls', formatting_info=True)
        wb = copy(rb)
        writeSheet = wb.get_sheet(0)
        writeSheet.write(x, y, value[0])
        writeSheet.write(x, y+1, value[1])
        wb.save(r'./monitor.xls')

    print("*" * 58)


if __name__ == '__main__':
    # 进程名
    ProcessName = 'python2.exe'
    x = 0
    y = 0

    while True:
        countProcessMemoey(ProcessName)
        x += 1
        time.sleep(5)
```

